# 语音唤醒提示音功能

## 概述

语音唤醒提示音功能在检测到唤醒词后播放音频提示，让用户知道设备已经被成功唤醒并开始监听。

## 功能特性

- **可配置的提示音**: 支持调整频率、持续时间和音量
- **双声提示音**: 提供更明显的提示效果（推荐）
- **单声提示音**: 简单的单次提示音
- **异步播放**: 不阻塞语音识别和对话流程
- **自动设备检测**: 自动选择默认音频输出设备

## 配置选项

在 `config/config.json` 文件的 `WAKE_WORD_OPTIONS.BEEP_ON_WAKE` 部分进行配置：

```json
{
  "WAKE_WORD_OPTIONS": {
    "BEEP_ON_WAKE": {
      "ENABLED": true,           // 是否启用提示音
      "FREQUENCY": 800.0,        // 提示音频率 (Hz)
      "DURATION": 0.3,           // 持续时间 (秒)
      "VOLUME": 0.3,             // 音量 (0.0-1.0)
      "USE_DOUBLE_BEEP": true    // 是否使用双声提示音
    }
  }
}
```

### 配置参数说明

- **ENABLED** (boolean): 是否启用提示音功能
- **FREQUENCY** (float): 提示音的频率，单位Hz。推荐范围 400-1200Hz
- **DURATION** (float): 提示音持续时间，单位秒。推荐范围 0.1-0.5秒
- **VOLUME** (float): 音量大小，范围 0.0-1.0。推荐 0.2-0.4
- **USE_DOUBLE_BEEP** (boolean): 是否使用双声提示音（更明显的效果）

## 使用方式

1. **自动启用**: 当语音唤醒功能启用且检测到唤醒词时，会自动播放提示音

2. **测试提示音**: 运行测试脚本来调试和调整提示音效果
   ```bash
   python3 scripts/test_beep.py
   ```

## 双声提示音

双声提示音播放两个不同频率的短音：
- 第一声: 600Hz, 0.15秒
- 短暂间隔: 0.05秒
- 第二声: 900Hz, 0.15秒

这种设计提供了更明显和愉悦的唤醒提示效果。

## 技术实现

- 使用 `numpy` 生成正弦波音频数据
- 使用 `sounddevice` 播放音频
- 支持淡入淡出效果，避免爆音
- 异步播放，不阻塞主程序流程
- 自动检测和使用系统默认音频输出设备

## 故障排除

### 常见问题

1. **没有声音**
   - 检查系统音量设置
   - 确认音频输出设备正常工作
   - 检查配置中 `ENABLED` 是否为 `true`

2. **ALSA 警告信息**
   - 这些是正常的系统级音频警告，不影响功能
   - 可以通过设置环境变量忽略：`export ALSA_PCM_CARD=0`

3. **提示音太大声/太小声**
   - 调整配置中的 `VOLUME` 参数
   - 推荐值在 0.2-0.4 之间

4. **提示音频率不合适**
   - 调整配置中的 `FREQUENCY` 参数
   - 低频 (400-600Hz): 更柔和
   - 中频 (700-900Hz): 平衡效果
   - 高频 (1000-1200Hz): 更明显

## 性能影响

- 提示音生成和播放在后台线程中进行，不影响语音识别性能
- 音频数据生成只在需要时进行，内存占用极小
- 播放持续时间短（通常 < 0.5秒），对系统资源影响微乎其微